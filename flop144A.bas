10 OSSEGP! = MAKEPOINTER(&H242,0)
20 OSOFSP! = MAKEPOINTER(&H27C,0)
25 OSSEG% = PEEK("W",OSSEGP!)
26 OSOFS% = PEEK("W",OSOFSP!)
30 OS! = MAKEPOINTER(OSOFS%, OSSEG%)
40 DCBLISTOFS% = PEEK("W",OS!)
50 DESIRED$ = "f0"
100 DCBLISTP! = MAKEPOINTER(DCBLISTOFS%, OSSEG%)
110 DCBOFS% = PEEK("W",DCBLISTP!)
120 IF DCBOFS% = 0 THEN END
121 IF DCBOFS% = -1 THEN END
122 IF DCBOFS%=255 THEN END
130 GOSUB 1000
140 BPS% = PEEK("W", MAKEPOINTER(DCBOFS% + 68, OSSEG%))
150 SPS% = PEEK("W", MAKEPOINTER(DCBOFS% + 70, OSSEG%))
160 TPS% = PEEK("W", MAKEPOINTER(DCBOFS% + 72, OSSEG%))
170 CPD% = PEEK("W", MAKEPOINTER(DCBOFS% + 74, OSSEG%))
180 PRINT DNAME$, BPS%, SPS%, TSP%, CPD%
190 IF DNAME$ = DESIRED$ THEN GOSUB 2000
200 DCBLISTOFS% = DCBLISTOFS% + 2
210 GOTO 100
999 END
1000 REM getdcbname
1005 DNAME$ = ""
1010 LENP! = MAKEPOINTER(DCBOFS%+6, OSSEG%)
1020 L% = PEEK("B", LENP!)
1030 REM print L%
1040 FOR I% = 1 TO L%
1050 NAMEP! = MAKEPOINTER(DCBOFS%+6+I%, OSSEG%)
1060 CH% = PEEK("B",NAMEP!)
1070 DNAME$ = DNAME$ + CHR$(CH%)
1080 NEXT I%
1090 RETURN
2000 PRINT "found"
2005 POKE "W", MAKEPOINTER(DCBOFS%+74, OSSEG%), &HB4
2010 RETURN
